"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.translations = void 0;
exports.t = t;
exports.getLang = getLang;
const translations = {
    uz: {
        alreadyRegistered: '✅ Siz allaqachon ro\'yxatdan o\'tgansiz!',
        openMiniApp: '🚀 Mini ilovani ochish:',
        openMiniAppBtn: '🌐 Mini ilova',
        welcome: '👋 Xush kelibsiz! Ro\'yxatdan o\'tish uchun kontaktni ulashing.',
        shareContact: '📱 Kontaktni ulashish',
        selectLanguage: '🌍 Iltimos, tilni tanlang:',
        shareLocation: '📍 Iltimos, joylashuvingizni ulashing:',
        shareLocationBtn: '📍 Joylashuvni ulashish',
        enterBlock: '🏢 Iltimos, bino raqamini kiriting:',
        enterEntrance: '🚪 Iltimos, podyezd raqamini kiriting:',
        enterApartment: '🏢 Iltimos, kvartira raqamingizni kiriting:',
        registrationComplete: '🎉 Ro\'yxatdan o\'tish muvaffaqiyatli yakunlandi! Rahmat.',
        shopArea: '🏪 Siz {shop} do\'konining hududidasiz! Buyurtmalar shu do\'kondan yetkaziladi. 😊',
        outOfService: '🚫 Afsuski, sizning hududingizda xizmat ko\'rsatmaymiz. Yangiliklar uchun ijtimoiy tarmoqlarimizni kuzatib boring! 📱\nInstagram, Telegram, Facebook: @yaqiin',
        orderPacked: '📦 Buyurtma qadoqlanmoqda!',
        orderPicked: '🚚 Kuryer buyurtmani oldi!',
        orderRejected: '❌ Buyurtma rad etildi!',
        rejectReasonPrompt: '❌ Buyurtmani rad etish sababi:',
        reasonOutOfStock: 'Tovar yo\'q',
        reasonClosed: 'Do\'kon yopiq',
        reasonOutOfArea: 'Xizmat hududidan tashqarida',
        reasonOther: 'Boshqa sabab',
        enterCustomReason: 'Sababni yozing:',
        noFurtherAction: 'Boshqa amal yo\'q.',
        orderNotFound: 'Buyurtma topilmadi',
        courierAccountConfigured: '✅ Hisob sozlandi!',
        // Menu translations
        greeting: '👋 Xush kelibsiz! Quyidagi menyudan tanlang:',
        myOrders: '📋 Mening buyurtmalarim',
        settings: '⚙️ Sozlamalar',
        changeLocation: '📍 Joylashuvni o\'zgartirish',
        changeLanguage: '🌍 Tilni o\'zgartirish',
        locationUpdated: '✅ Joylashuv muvaffaqiyatli yangilandi!',
        languageUpdated: '✅ Til muvaffaqiyatli o\'zgartirildi!',
        unknownCommand: '❓ Noma\'lum buyruq. Iltimos, menyudan tanlang:',
        noOrdersYet: '📋 Sizda hali buyurtmalar yo\'q. Ilovani ochib buyurtma bering!',
        recentOrders: '📋 Sizning so\'nggi buyurtmalaringiz:\n\n',
        orderNumber: 'Buyurtma #',
        back: 'Orqaga',
    },
    ru: {
        alreadyRegistered: '✅ Вы уже зарегистрированы!',
        openMiniApp: '🚀 Открыть мини-приложение:',
        openMiniAppBtn: '🌐 Мини-приложение',
        welcome: '👋 Добро пожаловать! Пожалуйста, поделитесь своим контактом для регистрации.',
        shareContact: '📱 Поделиться контактом',
        selectLanguage: '🌍 Пожалуйста, выберите язык:',
        shareLocation: '📍 Пожалуйста, поделитесь своим местоположением:',
        shareLocationBtn: '📍 Поделиться местоположением',
        enterBlock: '🏢 Пожалуйста, введите номер здания:',
        enterEntrance: '🚪 Пожалуйста, введите номер подъезда:',
        enterApartment: '🏢 Пожалуйста, введите номер квартиры:',
        registrationComplete: '🎉 Регистрация успешно завершена! Спасибо.',
        shopArea: '🏪 Вы находитесь в зоне магазина {shop}! Ваши заказы будут доставляться из этого магазина. 😊',
        outOfService: '🚫 К сожалению, мы не обслуживаем ваш район. Следите за нашими новостями в социальных сетях! 📱\nInstagram, Telegram, Facebook: @yaqiin',
        orderPacked: '📦 Заказ упаковывается!',
        orderPicked: '🚚 Курьер забрал заказ!',
        orderRejected: '❌ Заказ отклонён!',
        rejectReasonPrompt: '❌ Причина отклонения заказа:',
        reasonOutOfStock: 'Нет товара',
        reasonClosed: 'Магазин закрыт',
        reasonOutOfArea: 'Вне зоны обслуживания',
        reasonOther: 'Другая причина',
        enterCustomReason: 'Напишите причину:',
        noFurtherAction: 'Нет дальнейших действий.',
        orderNotFound: 'Заказ не найден',
        courierAccountConfigured: '✅ Аккаунт настроен!',
        // Menu translations
        greeting: '👋 Добро пожаловать! Выберите из меню ниже:',
        myOrders: '📋 Мои заказы',
        settings: '⚙️ Настройки',
        changeLocation: '📍 Изменить местоположение',
        changeLanguage: '🌍 Изменить язык',
        locationUpdated: '✅ Местоположение успешно обновлено!',
        languageUpdated: '✅ Язык успешно изменен!',
        unknownCommand: '❓ Неизвестная команда. Пожалуйста, выберите из меню:',
        noOrdersYet: '📋 У вас пока нет заказов. Откройте приложение и сделайте заказ!',
        recentOrders: '📋 Ваши последние заказы:\n\n',
        orderNumber: 'Заказ #',
        back: 'Назад',
    },
    en: {
        alreadyRegistered: '✅ You are already registered!',
        openMiniApp: '🚀 Open the Mini App:',
        openMiniAppBtn: '🌐 Open Mini App',
        welcome: '👋 Welcome! Please share your contact to register.',
        shareContact: '📱 Share Contact',
        selectLanguage: '🌍 Please select your language:',
        shareLocation: '📍 Please share your location:',
        shareLocationBtn: '📍 Share Location',
        enterBlock: '🏢 Please enter the building number:',
        enterEntrance: '🚪 Please enter the entrance number:',
        enterApartment: '🏢 Please enter the apartment number:',
        registrationComplete: '🎉 Registration complete! Thank you.',
        shopArea: '🏪 You are in the delivery area of {shop}! Orders will be delivered from this shop. 😊',
        outOfService: '🚫 Unfortunately, we do not serve your area yet. Follow us on social media for updates! 📱\nInstagram, Telegram, Facebook: @yaqiin',
        orderPacked: '📦 Order is being packed!',
        orderPicked: '🚚 Courier picked up the order!',
        orderRejected: '❌ Order has been rejected!',
        rejectReasonPrompt: '❌ Reason for order rejection:',
        reasonOutOfStock: 'Out of stock',
        reasonClosed: 'Shop closed',
        reasonOutOfArea: 'Out of service area',
        reasonOther: 'Other reason',
        enterCustomReason: 'Please enter the reason:',
        noFurtherAction: 'No further action available.',
        orderNotFound: 'Order not found',
        courierAccountConfigured: '✅ Account configured!',
        // Menu translations
        greeting: '👋 Welcome! Please select from the menu below:',
        myOrders: '📋 My Orders',
        settings: '⚙️ Settings',
        changeLocation: '📍 Change Location',
        changeLanguage: '🌍 Change Language',
        locationUpdated: '✅ Location updated successfully!',
        languageUpdated: '✅ Language changed successfully!',
        unknownCommand: '❓ Unknown command. Please select from the menu:',
        noOrdersYet: '📋 You don\'t have any orders yet. Open the app and place an order!',
        recentOrders: '📋 Your recent orders:\n\n',
        orderNumber: 'Order #',
        back: 'Back',
    },
};
exports.translations = translations;
// Courier bot translations
Object.assign(translations.uz, {
    courierWelcome: '👋 Xush kelibsiz! Bu bot orqali siz buyurtmalarni boshqarishingiz mumkin. Operator yoki administrator yuborgan kodni kiriting.',
    courierAskCode: 'Iltimos, operator yoki administrator yuborgan kodni kiriting.',
    courierInvalidCode: '❌ Kod noto\'g\'ri. Iltimos, to\'g\'ri kod kiriting.',
    courierAskLanguage: '🌍 Iltimos, tilni tanlang:',
    courierConfiguredCourier: '🚚 Sizning hisobingiz kuryer sifatida sozlandi. Endi buyurtmalarni qabul qilishingiz mumkin!',
    courierConfiguredShopOwner: '🏪 Sizning hisobingiz do\'kon egasi sifatida sozlandi. Endi buyurtmalarni boshqarishingiz mumkin!',
    courierSuccess: '✅ Xush kelibsiz, {name}! Tilni tanlang:',
    courierOrderPicked: '🚚 Buyurtma kuryerda!',
    courierOrderDelivered: '📦 Buyurtma yetkazib berildi!',
    courierOrderRejected: '❌ Buyurtma rad etildi!',
    courierRejectReasonPrompt: '❌ Buyurtmani rad etish sababi:',
    courierReasonNoContact: 'Mijoz bilan bog\'lanib bo\'lmadi',
    courierReasonNoAddress: 'Manzil topilmadi',
    courierReasonOther: 'Boshqa sabab',
    courierEnterCustomReason: 'Sababni yozing:',
    courierNoFurtherAction: 'Boshqa amal yo\'q.',
    courierOrderNotFound: 'Buyurtma topilmadi',
});
Object.assign(translations.ru, {
    courierWelcome: '👋 Добро пожаловать! С помощью этого бота вы можете управлять заказами. Введите код, который отправил оператор или администратор.',
    courierAskCode: 'Пожалуйста, введите код, отправленный оператором или администратором.',
    courierInvalidCode: '❌ Неверный код. Пожалуйста, введите правильный код.',
    courierAskLanguage: '🌍 Пожалуйста, выберите язык:',
    courierConfiguredCourier: '🚚 Ваша учетная запись настроена как курьер. Теперь вы можете принимать заказы!',
    courierConfiguredShopOwner: '🏪 Ваша учетная запись настроена как владелец магазина. Теперь вы можете управлять заказами!',
    courierSuccess: '✅ Добро пожаловать, {name}! Пожалуйста, выберите язык:',
    courierOrderPicked: '🚚 Заказ у курьера!',
    courierOrderDelivered: '📦 Заказ доставлен!',
    courierOrderRejected: '❌ Заказ отклонён!',
    courierRejectReasonPrompt: '❌ Причина отклонения заказа:',
    courierReasonNoContact: 'Не удалось связаться с клиентом',
    courierReasonNoAddress: 'Адрес не найден',
    courierReasonOther: 'Другая причина',
    courierEnterCustomReason: 'Напишите причину:',
    courierNoFurtherAction: 'Нет дальнейших действий.',
    courierOrderNotFound: 'Заказ не найден',
});
Object.assign(translations.en, {
    courierWelcome: '👋 Welcome! You can manage orders with this bot. Please enter the code sent by the operator or administrator.',
    courierAskCode: 'Please enter the code sent by the operator or administrator.',
    courierInvalidCode: '❌ Invalid code. Please enter the correct code.',
    courierAskLanguage: '🌍 Please select your language:',
    courierConfiguredCourier: '🚚 Your account is set up as a courier. You can now accept orders!',
    courierConfiguredShopOwner: '🏪 Your account is set up as a shop owner. You can now manage orders!',
    courierSuccess: '✅ Welcome, {name}! Please select your language:',
    courierOrderPicked: '🚚 Order is with the courier!',
    courierOrderDelivered: '📦 Order delivered!',
    courierOrderRejected: '❌ Order has been rejected!',
    courierRejectReasonPrompt: '❌ Reason for order rejection:',
    courierReasonNoContact: 'Could not contact customer',
    courierReasonNoAddress: 'Address not found',
    courierReasonOther: 'Other reason',
    courierEnterCustomReason: 'Please enter the reason:',
    courierNoFurtherAction: 'No further action available.',
    courierOrderNotFound: 'Order not found',
});
// Additional order/courier flow translations used by bots and notifications
Object.assign(translations.uz, {
    newOrderLabel: '🆕 Yangi buyurtma!',
    orderIdLabel: 'Buyurtma ID:',
    clientLabel: 'Mijoz:',
    productsLabel: 'Mahsulotlar',
    totalLabel: 'Umumiy:',
    nextStepLabel: 'Keyingi bosqich:',
    acceptOrRejectOrder: 'Buyurtmani qabul qiling yoki rad eting',
    acceptBtn: 'Qabul qilish',
    rejectBtn: 'Rad etish',
    orderConfirmedSentToShop: 'Buyurtma tasdiqlandi va do\'konga yuborildi',
    orderAcceptedSentToShop: 'Buyurtma qabul qilindi va do\'konga yuborildi',
    pleaseReviewOrder: 'Iltimos, buyurtmani ko\'rib chiqing',
    orderCannotBeAccepted: 'Bu buyurtmani qabul qilib bo\'lmaydi',
    orderPackingStage: 'Buyurtma qadoqlash bosqichida',
    finishPackingBtn: 'Qadoqlash tugadi',
    pressFinishPacking: 'Tayyor bo\'lganda "Qadoqlash tugadi" tugmasini bosing',
    orderAcceptedPackingStage: 'Buyurtma qadoqlash bosqichiga o\'tkazildi',
    orderCannotBeFinished: 'Qadoqlashni tugatib bo\'lmaydi',
    orderReadyLabel: 'Buyurtma tayyor',
    pickedUpBtn: 'Olib ketdim',
    orderOnTheWay: 'Buyurtma yo\'lda',
    pressPickedUpOrReject: 'Iltimos, "Olib ketdim" yoki "Rad etish" tugmasini bosing',
    orderCannotBePickedUp: 'Buyurtmani olib ketib bo\'lmaydi',
    pressDeliveredWhenDone: 'Yetkazilganda "Yetkazildi" tugmasini bosing',
    deliveredBtn: 'Yetkazildi',
    orderCannotBeDelivered: 'Buyurtmani yetkazilgan deb belgilab bo\'lmaydi',
    orderDeliveredLabel: 'Buyurtma yetkazildi',
    clientPaidBtn: 'Mijoz to\'ladi',
    clientRejectedBtn: 'Mijoz rad etdi',
    pressPaidOrRejected: 'Iltimos, "Mijoz to\'ladi" yoki "Mijoz rad etdi" tugmasini bosing',
    orderCannotBePaid: 'Buyurtmani to\'langan deb belgilab bo\'lmaydi',
    orderPaidFinal: 'Buyurtma to\'landi',
    pleaseProvideRejectionReason: 'Iltimos, rad etish sababini yozing:',
    orderRejectedFinal: 'Buyurtma rad etildi.',
    orderPickedUp: 'Buyurtma olib ketildi',
    orderDelivered: 'Buyurtma yetkazildi',
    orderRejectedByShopOwner: 'Buyurtma do\'kon egasi tomonidan rad etildi',
    userNotFound: 'Foydalanuvchi topilmadi',
    userNotFoundInDB: 'Foydalanuvchi bazada topilmadi',
    orderCannotBeRejected: 'Buyurtmani rad etib bo\'lmaydi',
    // Additional hardcoded strings found in bots
    orderPacked: 'Buyurtma qadoqlandi!',
    orderPickedByCourier: 'Kuryer buyurtmani oldi!',
    noFurtherAction: 'Boshqa amal yo\'q.',
    packingFinishedSentToCouriers: 'Qadoqlash tugallandi va buyurtma kuryerlarga yuborildi!',
    orderStatusChanged: 'Buyurtma holati "{status}" ga o\'zgartirildi',
    noPermissionToChangeStatus: 'Sizda buyurtma holatini o\'zgartirish huquqi yo\'q',
    enterRejectionReason: 'Rad etish sababini kiriting:',
    // Status translations
    statusCreated: '🆕 Yangi',
    statusPacking: '📦 Tayyorlanmoqda',
    statusCourierPicked: '🚚 Yo\'lda',
    statusDelivered: '✅ Yetkazildi',
    statusCompleted: '✅ Tugallandi',
    statusRejected: '❌ Rad etildi',
    currency: 'so\'m',
});
Object.assign(translations.ru, {
    newOrderLabel: '🆕 Новый заказ!',
    orderIdLabel: 'ID заказа:',
    clientLabel: 'Клиент:',
    productsLabel: 'Товары',
    totalLabel: 'Итого:',
    nextStepLabel: 'Следующий шаг:',
    acceptOrRejectOrder: 'Примите или отклоните заказ',
    acceptBtn: 'Принять',
    rejectBtn: 'Отклонить',
    orderConfirmedSentToShop: 'Заказ подтверждён и отправлен в магазин',
    orderAcceptedSentToShop: 'Заказ принят и отправлен в магазин',
    pleaseReviewOrder: 'Пожалуйста, проверьте заказ',
    orderCannotBeAccepted: 'Этот заказ нельзя принять',
    orderPackingStage: 'Заказ на этапе упаковки',
    finishPackingBtn: 'Упаковка завершена',
    pressFinishPacking: 'Когда готово, нажмите «Упаковка завершена»',
    orderAcceptedPackingStage: 'Заказ переведён на этап упаковки',
    orderCannotBeFinished: 'Нельзя завершить упаковку',
    orderReadyLabel: 'Заказ готов',
    pickedUpBtn: 'Забрал',
    orderOnTheWay: 'Заказ в пути',
    pressPickedUpOrReject: 'Нажмите «Забрал» или «Отклонить»',
    orderCannotBePickedUp: 'Нельзя забрать заказ',
    pressDeliveredWhenDone: 'Когда доставите, нажмите «Доставлен»',
    deliveredBtn: 'Доставлен',
    orderCannotBeDelivered: 'Нельзя отметить как доставленный',
    orderDeliveredLabel: 'Заказ доставлен',
    clientPaidBtn: 'Клиент оплатил',
    clientRejectedBtn: 'Клиент отказался',
    pressPaidOrRejected: 'Нажмите «Клиент оплатил» или «Клиент отказался»',
    orderCannotBePaid: 'Нельзя отметить как оплаченный',
    orderPaidFinal: 'Заказ оплачен',
    pleaseProvideRejectionReason: 'Пожалуйста, укажите причину отказа:',
    orderRejectedFinal: 'Заказ отклонён.',
    orderPickedUp: 'Заказ забран',
    orderDelivered: 'Заказ доставлен',
    orderRejectedByShopOwner: 'Заказ отклонён владельцем магазина',
    userNotFound: 'Пользователь не найден',
    userNotFoundInDB: 'Пользователь не найден в базе',
    orderCannotBeRejected: 'Нельзя отклонить заказ',
    // Additional hardcoded strings found in bots
    orderPacked: 'Заказ упакован!',
    orderPickedByCourier: 'Курьер забрал заказ!',
    noFurtherAction: 'Нет дальнейших действий.',
    packingFinishedSentToCouriers: 'Упаковка завершена и заказ отправлен курьерам!',
    orderStatusChanged: 'Статус заказа изменён на "{status}"',
    noPermissionToChangeStatus: 'У вас нет прав для изменения статуса заказа',
    enterRejectionReason: 'Укажите причину отказа:',
    // Status translations
    statusCreated: '🆕 Новый',
    statusPacking: '📦 Готовится',
    statusCourierPicked: '🚚 В пути',
    statusDelivered: '✅ Доставлен',
    statusCompleted: '✅ Завершен',
    statusRejected: '❌ Отклонен',
    currency: 'сум',
});
Object.assign(translations.en, {
    newOrderLabel: '🆕 New order!',
    orderIdLabel: 'Order ID:',
    clientLabel: 'Client:',
    productsLabel: 'Products',
    totalLabel: 'Total:',
    nextStepLabel: 'Next step:',
    acceptOrRejectOrder: 'Accept or reject the order',
    acceptBtn: 'Accept',
    rejectBtn: 'Reject',
    orderConfirmedSentToShop: 'Order confirmed and sent to the shop',
    orderAcceptedSentToShop: 'Order accepted and sent to the shop',
    pleaseReviewOrder: 'Please review the order',
    orderCannotBeAccepted: 'This order cannot be accepted',
    orderPackingStage: 'Order packing stage',
    finishPackingBtn: 'Finish packing',
    pressFinishPacking: 'When ready, press "Finish packing"',
    orderAcceptedPackingStage: 'Order moved to packing stage',
    orderCannotBeFinished: 'Cannot finish packing',
    orderReadyLabel: 'Order is ready',
    pickedUpBtn: 'Picked up',
    orderOnTheWay: 'Order on the way',
    pressPickedUpOrReject: 'Press "Picked up" or "Reject"',
    orderCannotBePickedUp: 'Cannot mark as picked up',
    pressDeliveredWhenDone: 'Press "Delivered" when done',
    deliveredBtn: 'Delivered',
    orderCannotBeDelivered: 'Cannot mark as delivered',
    orderDeliveredLabel: 'Order delivered',
    clientPaidBtn: 'Client paid',
    clientRejectedBtn: 'Client rejected',
    pressPaidOrRejected: 'Press "Client paid" or "Client rejected"',
    orderCannotBePaid: 'Cannot mark as paid',
    orderPaidFinal: 'Order paid',
    pleaseProvideRejectionReason: 'Please provide a reason for rejection:',
    orderRejectedFinal: 'Order rejected.',
    orderPickedUp: 'Order picked up',
    orderDelivered: 'Order delivered',
    orderRejectedByShopOwner: 'Order rejected by shop owner',
    userNotFound: 'User not found',
    userNotFoundInDB: 'User not found in DB',
    orderCannotBeRejected: 'Cannot reject order',
    // Additional hardcoded strings found in bots
    orderPacked: 'Order packed!',
    orderPickedByCourier: 'Order picked by courier!',
    noFurtherAction: 'No further action.',
    packingFinishedSentToCouriers: 'Packing finished and order sent to couriers!',
    orderStatusChanged: 'Order status changed to "{status}"',
    noPermissionToChangeStatus: 'You do not have permission to change order status',
    enterRejectionReason: 'Please provide a reason for rejection:',
    // Status translations
    statusCreated: '🆕 New',
    statusPacking: '📦 Packing',
    statusCourierPicked: '🚚 On the way',
    statusDelivered: '✅ Delivered',
    statusCompleted: '✅ Completed',
    statusRejected: '❌ Rejected',
    currency: 'sum',
});
function getLang(ctx, fallback = 'en') {
    // Try to extract language from registration state, session, or fallback
    if (ctx) {
        const telegramId = ctx.from && ctx.from.id ? String(ctx.from.id) : undefined;
        // First priority: Check registration state (for users in registration process)
        if (telegramId && ctx.registrationState && ctx.registrationState.get) {
            const state = ctx.registrationState.get(telegramId);
            if (state && state.language) {
                console.log("[i18n] Language from registration state:", state.language);
                return state.language;
            }
        }
        // Second priority: Check session user (for registered users)
        if (ctx.sessionUserMap && ctx.sessionUserMap.get) {
            const user = ctx.sessionUserMap.get(ctx);
            if (user && user.preferences && user.preferences.language) {
                console.log("[i18n] Language from session user:", user.preferences.language);
                return user.preferences.language;
            }
        }
        // Third priority: Check Telegram language code
        if (ctx.from && ctx.from.language_code) {
            const code = ctx.from.language_code.split('-')[0];
            if (translations[code]) {
                console.log("[i18n] Language from Telegram:", code);
                return code;
            }
        }
    }
    console.log("[i18n] Using fallback language:", fallback);
    return fallback;
}
function t(ctx, key, params) {
    var _a;
    const lang = getLang(ctx);
    let str = ((_a = translations[lang]) === null || _a === void 0 ? void 0 : _a[key]) || translations['en'][key] || key;
    if (params) {
        Object.entries(params).forEach(([k, v]) => {
            str = str.replace(`{${k}}`, String(v));
        });
    }
    return str;
}
